<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>{% if page.title %}{{ page.title }} – {% endif %}{{ site.name }} – {{ site.description }}</title>

  {% include meta.html %}

  <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link rel="alternate" type="application/rss+xml" title="{{ site.name }} - {{ site.description }}" href="{{ site.baseurl }}/feed.xml" />

  <title>Timothy Ellison - Web Developer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon" type="image/x-icon" href="../images/favicon.ico?">
  <link href="https://fonts.googleapis.com/css?family=EB+Garamond" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="{{ site.baseurl }}/style.css">
</head>
<body>
  <div id="spinner" class="spinner">
    <i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>
    <span class="sr-only">Loading...</span>
  </div>
  <div id="contentWrapper" class="page content-wrapper hidden">
    <header class="header" id="header" data-title={{ page.title }}>
      <div class="header__text">
        <h1 class="header__title"><a href="http://www.timothyellison.com/">Timothy Ellison</a></h1>
        <h2>Web Developer</h2>
      </div>
    </header>

    <main class="main hidden" role="main" id="mainContent">
      {{ content }}
    </main>

    <footer class="footer">
      Timothy Ellison &copy; 2017
    </footer>
  </div>

  <script>
      var myImages = [];
      var header = document.getElementById('header');
      var headerTitle = header.dataset.title;
      var spinner = document.getElementById('spinner');
      var contentWrapper = document.getElementById('contentWrapper');

      var backgroundImages = {
        Comcast: 'http://www.ramsa.com/api/sites/default/files/A00007-ESTO-2008A63.420_0.jpg',
        Contribution: 'https://d2v9y0dukr6mq2.cloudfront.net/video/thumbnail/1809Tdj/footage-of-computer-display-screen-with-green-moving-text-with-code-in-the-terminal-software_sjbizma2_thumbnail-full01.png'
      }
      var defaultImage = '../images/jesse-gardner-med.jpg';

      if (backgroundImages[headerTitle]) {
        myImages.push(backgroundImages[headerTitle]);
      } else {
        myImages.push(defaultImage);
      }

      function loadImages (images) {
        let loader = function (src) {
          return new Promise(function (resolve, reject) {
            let img = new Image();
            img.onload = function () {
              resolve(src);
            };
            img.onerror = function (err) {
              reject(err);
            };
            img.src = src;
          });
        };

        let loaders = [];
        images.forEach(function (image) {
          loaders.push(loader(image));
        });

        return Promise.all(loaders);
      }

      function setBackground (images) {
        header.style.backgroundImage = 'url("' + images[0] + '")';
      }

      function reveal () {
        contentWrapper.classList.remove('hidden');
        spinner.classList.add('hidden');
      }

      loadImages(myImages)
      .then(setBackground)
      .then(reveal)
      .catch(function (err) {
        console.error(err);
      });

    var mainContent = document.getElementById('mainContent');

    window.addEventListener('scroll', function(e) {
      if (window.scrollY >= (mainContent.offsetTop - 500)) {
        mainContent.classList.remove('hidden');
      }
    });
  </script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-52933192-2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-52933192-2');
  </script>
  </body>
</html>
